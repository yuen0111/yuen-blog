{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 51, "column": 0}, "map": {"version":3,"sources":["file:///Users/yuanko/Developer/html-css-course/personal-blog/lib/posts.ts"],"sourcesContent":["import fs from 'node:fs/promises';\nimport path from 'node:path';\nimport matter from 'gray-matter';\nimport { compileMDX } from 'next-mdx-remote/rsc';\nimport remarkGfm from 'remark-gfm';\nimport rehypeSlug from 'rehype-slug';\nimport rehypeAutolinkHeadings from 'rehype-autolink-headings';\nimport { cache, type ReactNode } from 'react';\n\nconst POSTS_DIR = path.join(process.cwd(), 'content/posts');\n\nexport interface PostFrontmatter {\n  title: string;\n  summary?: string;\n  publishedAt: string;\n  tags?: string[];\n  draft?: boolean;\n}\n\nexport interface PostMetadata {\n  slug: string;\n  title: string;\n  summary: string;\n  publishedAt: string;\n  tags: string[];\n}\n\nexport interface Post extends PostMetadata {\n  content: ReactNode;\n}\n\nfunction isPostFrontmatter(value: unknown): value is PostFrontmatter {\n  if (!value || typeof value !== 'object') {\n    return false;\n  }\n\n  const data = value as Record<string, unknown>;\n\n  return typeof data.title === 'string' && typeof data.publishedAt === 'string';\n}\n\nasync function readPostFile(slug: string) {\n  const filePath = path.join(POSTS_DIR, `${slug}.mdx`);\n  return fs.readFile(filePath, 'utf8');\n}\n\nasync function listPostFiles(): Promise<string[]> {\n  const files = await fs.readdir(POSTS_DIR);\n  return files\n    .filter((file: string) => file.endsWith('.mdx'))\n    .map((file: string) => file.replace(/\\.mdx$/, ''));\n}\n\nfunction normalizeMetadata(slug: string, data: PostFrontmatter): PostMetadata {\n  return {\n    slug,\n    title: data.title,\n    summary: data.summary ?? '',\n    publishedAt: data.publishedAt,\n    tags: data.tags ?? []\n  };\n}\n\nexport const getAllPosts = cache(async (): Promise<PostMetadata[]> => {\n  const slugs = await listPostFiles();\n  const posts = await Promise.all(\n    slugs.map(async (slug: string) => {\n      const source = await readPostFile(slug);\n      const { data } = matter(source);\n\n      if (!isPostFrontmatter(data) || data.draft) {\n        return null;\n      }\n\n      return normalizeMetadata(slug, data);\n    })\n  );\n\n  return posts\n    .filter((post): post is PostMetadata => Boolean(post))\n    .sort(\n      (a, b) => new Date(b.publishedAt).getTime() - new Date(a.publishedAt).getTime()\n    );\n});\n\nexport async function getPostBySlug(slug: string): Promise<Post> {\n  const source = await readPostFile(slug);\n\n  const { content, frontmatter } = await compileMDX<PostFrontmatter>({\n    source,\n    options: {\n      parseFrontmatter: true,\n      mdxOptions: {\n        remarkPlugins: [remarkGfm],\n        rehypePlugins: [rehypeSlug, [rehypeAutolinkHeadings, { behavior: 'wrap' }]]\n      }\n    }\n  });\n\n  if (!isPostFrontmatter(frontmatter) || frontmatter.draft) {\n    throw new Error(`Post \"${slug}\" is missing required frontmatter.`);\n  }\n\n  return {\n    ...normalizeMetadata(slug, frontmatter),\n    content\n  };\n}\n\nexport const getPostSlugs = cache(async () => listPostFiles());\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AAEA,MAAM,YAAY,4HAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI;AAsB3C,SAAS,kBAAkB,KAAc;IACvC,IAAI,CAAC,SAAS,OAAO,UAAU,UAAU;QACvC,OAAO;IACT;IAEA,MAAM,OAAO;IAEb,OAAO,OAAO,KAAK,KAAK,KAAK,YAAY,OAAO,KAAK,WAAW,KAAK;AACvE;AAEA,eAAe,aAAa,IAAY;IACtC,MAAM,WAAW,4HAAI,CAAC,IAAI,CAAC,WAAW,GAAG,KAAK,IAAI,CAAC;IACnD,OAAO,gJAAE,CAAC,QAAQ,CAAC,UAAU;AAC/B;AAEA,eAAe;IACb,MAAM,QAAQ,MAAM,gJAAE,CAAC,OAAO,CAAC;IAC/B,OAAO,MACJ,MAAM,CAAC,CAAC,OAAiB,KAAK,QAAQ,CAAC,SACvC,GAAG,CAAC,CAAC,OAAiB,KAAK,OAAO,CAAC,UAAU;AAClD;AAEA,SAAS,kBAAkB,IAAY,EAAE,IAAqB;IAC5D,OAAO;QACL;QACA,OAAO,KAAK,KAAK;QACjB,SAAS,KAAK,OAAO,IAAI;QACzB,aAAa,KAAK,WAAW;QAC7B,MAAM,KAAK,IAAI,IAAI,EAAE;IACvB;AACF;AAEO,MAAM,cAAc,IAAA,8MAAK,EAAC;IAC/B,MAAM,QAAQ,MAAM;IACpB,MAAM,QAAQ,MAAM,QAAQ,GAAG,CAC7B,MAAM,GAAG,CAAC,OAAO;QACf,MAAM,SAAS,MAAM,aAAa;QAClC,MAAM,EAAE,IAAI,EAAE,GAAG,IAAA,kJAAM,EAAC;QAExB,IAAI,CAAC,kBAAkB,SAAS,KAAK,KAAK,EAAE;YAC1C,OAAO;QACT;QAEA,OAAO,kBAAkB,MAAM;IACjC;IAGF,OAAO,MACJ,MAAM,CAAC,CAAC,OAA+B,QAAQ,OAC/C,IAAI,CACH,CAAC,GAAG,IAAM,IAAI,KAAK,EAAE,WAAW,EAAE,OAAO,KAAK,IAAI,KAAK,EAAE,WAAW,EAAE,OAAO;AAEnF;AAEO,eAAe,cAAc,IAAY;IAC9C,MAAM,SAAS,MAAM,aAAa;IAElC,MAAM,EAAE,OAAO,EAAE,WAAW,EAAE,GAAG,MAAM,IAAA,sKAAU,EAAkB;QACjE;QACA,SAAS;YACP,kBAAkB;YAClB,YAAY;gBACV,eAAe;oBAAC,wJAAS;iBAAC;gBAC1B,eAAe;oBAAC,yJAAU;oBAAE;wBAAC,yKAAsB;wBAAE;4BAAE,UAAU;wBAAO;qBAAE;iBAAC;YAC7E;QACF;IACF;IAEA,IAAI,CAAC,kBAAkB,gBAAgB,YAAY,KAAK,EAAE;QACxD,MAAM,IAAI,MAAM,CAAC,MAAM,EAAE,KAAK,kCAAkC,CAAC;IACnE;IAEA,OAAO;QACL,GAAG,kBAAkB,MAAM,YAAY;QACvC;IACF;AACF;AAEO,MAAM,eAAe,IAAA,8MAAK,EAAC,UAAY","debugId":null}},
    {"offset": {"line": 154, "column": 0}, "map": {"version":3,"sources":["file:///Users/yuanko/Developer/html-css-course/personal-blog/app/posts/%5Bslug%5D/page.tsx"],"sourcesContent":["import type { Metadata } from 'next';\nimport { notFound } from 'next/navigation';\nimport Link from 'next/link';\nimport { getAllPosts, getPostBySlug, getPostSlugs, type PostMetadata } from '@/lib/posts';\nimport { absoluteUrl, siteConfig } from '@/lib/site-config';\n\ninterface PostPageProps {\n  params: Promise<{ slug: string }>;\n}\n\nexport async function generateStaticParams() {\n  const slugs = await getPostSlugs();\n  return slugs.map((slug: string) => ({ slug }));\n}\n\nexport async function generateMetadata({ params }: PostPageProps): Promise<Metadata> {\n  const { slug } = await params;\n  const post = await getPostBySlug(slug).catch(() => null);\n\n  if (!post) {\n    return { title: '文章未找到' };\n  }\n\n  const url = absoluteUrl(`/posts/${slug}`);\n\n  return {\n    title: post.title,\n    description: post.summary,\n    openGraph: {\n      title: post.title,\n      description: post.summary,\n      url,\n      siteName: siteConfig.name,\n      type: 'article'\n    },\n    twitter: {\n      card: 'summary_large_image',\n      title: post.title,\n      description: post.summary\n    }\n  };\n}\n\nexport default async function PostPage({ params }: PostPageProps) {\n  const { slug } = await params;\n  const posts = await getAllPosts();\n  const post = await getPostBySlug(slug).catch(() => null);\n\n  if (!post) {\n    notFound();\n  }\n\n  const currentPost = post!;\n  const currentIndex = posts.findIndex((item: PostMetadata) => item.slug === slug);\n  const previous = currentIndex > 0 ? posts[currentIndex - 1] : null;\n  const next = currentIndex < posts.length - 1 ? posts[currentIndex + 1] : null;\n\n  return (\n    <article className=\"prose prose-slate max-w-none\">\n      <header className=\"not-prose mb-10 space-y-4\">\n        <Link href=\"/\" className=\"text-sm text-slate-500 hover:text-slate-900\">\n          ← 返回首页\n        </Link>\n        <div className=\"flex items-center gap-3 text-sm text-slate-500\">\n          <time>{currentPost.publishedAt}</time>\n          <span>·</span>\n          <span>{currentPost.tags.join(' / ') || '未分类'}</span>\n        </div>\n        <h1 className=\"text-3xl font-bold text-slate-900 sm:text-4xl\">{currentPost.title}</h1>\n        {currentPost.summary ? (\n          <p className=\"text-base text-slate-600\">{currentPost.summary}</p>\n        ) : null}\n      </header>\n\n      <div className=\"prose-headings:scroll-mt-24 prose-a:text-sky-600 prose-pre:bg-transparent\">\n        {currentPost.content}\n      </div>\n\n      <footer className=\"not-prose mt-16 grid gap-6 border-t border-slate-200 pt-8 text-sm\">\n        {previous ? (\n          <Link href={`/posts/${previous.slug}`} className=\"group block\">\n            <span className=\"text-xs uppercase tracking-wide text-slate-400\">上一篇</span>\n            <p className=\"text-sm font-medium text-slate-700 group-hover:text-slate-900\">\n              {previous.title}\n            </p>\n          </Link>\n        ) : null}\n        {next ? (\n          <Link href={`/posts/${next.slug}`} className=\"group block\">\n            <span className=\"text-xs uppercase tracking-wide text-slate-400\">下一篇</span>\n            <p className=\"text-sm font-medium text-slate-700 group-hover:text-slate-900\">{next.title}</p>\n          </Link>\n        ) : null}\n      </footer>\n    </article>\n  );\n}\n"],"names":[],"mappings":";;;;;;;;;AACA;AAAA;AACA;AACA;AACA;;;;;;;;;;AAMO,eAAe;IACpB,MAAM,QAAQ,MAAM,IAAA,4HAAY;IAChC,OAAO,MAAM,GAAG,CAAC,CAAC,OAAiB,CAAC;YAAE;QAAK,CAAC;AAC9C;AAEO,eAAe,iBAAiB,EAAE,MAAM,EAAiB;IAC9D,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM;IACvB,MAAM,OAAO,MAAM,IAAA,6HAAa,EAAC,MAAM,KAAK,CAAC,IAAM;IAEnD,IAAI,CAAC,MAAM;QACT,OAAO;YAAE,OAAO;QAAQ;IAC1B;IAEA,MAAM,MAAM,IAAA,oIAAW,EAAC,CAAC,OAAO,EAAE,MAAM;IAExC,OAAO;QACL,OAAO,KAAK,KAAK;QACjB,aAAa,KAAK,OAAO;QACzB,WAAW;YACT,OAAO,KAAK,KAAK;YACjB,aAAa,KAAK,OAAO;YACzB;YACA,UAAU,mIAAU,CAAC,IAAI;YACzB,MAAM;QACR;QACA,SAAS;YACP,MAAM;YACN,OAAO,KAAK,KAAK;YACjB,aAAa,KAAK,OAAO;QAC3B;IACF;AACF;AAEe,eAAe,SAAS,EAAE,MAAM,EAAiB;IAC9D,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM;IACvB,MAAM,QAAQ,MAAM,IAAA,2HAAW;IAC/B,MAAM,OAAO,MAAM,IAAA,6HAAa,EAAC,MAAM,KAAK,CAAC,IAAM;IAEnD,IAAI,CAAC,MAAM;QACT,IAAA,iMAAQ;IACV;IAEA,MAAM,cAAc;IACpB,MAAM,eAAe,MAAM,SAAS,CAAC,CAAC,OAAuB,KAAK,IAAI,KAAK;IAC3E,MAAM,WAAW,eAAe,IAAI,KAAK,CAAC,eAAe,EAAE,GAAG;IAC9D,MAAM,OAAO,eAAe,MAAM,MAAM,GAAG,IAAI,KAAK,CAAC,eAAe,EAAE,GAAG;IAEzE,qBACE,8OAAC;QAAQ,WAAU;;0BACjB,8OAAC;gBAAO,WAAU;;kCAChB,8OAAC,uKAAI;wBAAC,MAAK;wBAAI,WAAU;kCAA8C;;;;;;kCAGvE,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;0CAAM,YAAY,WAAW;;;;;;0CAC9B,8OAAC;0CAAK;;;;;;0CACN,8OAAC;0CAAM,YAAY,IAAI,CAAC,IAAI,CAAC,UAAU;;;;;;;;;;;;kCAEzC,8OAAC;wBAAG,WAAU;kCAAiD,YAAY,KAAK;;;;;;oBAC/E,YAAY,OAAO,iBAClB,8OAAC;wBAAE,WAAU;kCAA4B,YAAY,OAAO;;;;;+BAC1D;;;;;;;0BAGN,8OAAC;gBAAI,WAAU;0BACZ,YAAY,OAAO;;;;;;0BAGtB,8OAAC;gBAAO,WAAU;;oBACf,yBACC,8OAAC,uKAAI;wBAAC,MAAM,CAAC,OAAO,EAAE,SAAS,IAAI,EAAE;wBAAE,WAAU;;0CAC/C,8OAAC;gCAAK,WAAU;0CAAiD;;;;;;0CACjE,8OAAC;gCAAE,WAAU;0CACV,SAAS,KAAK;;;;;;;;;;;+BAGjB;oBACH,qBACC,8OAAC,uKAAI;wBAAC,MAAM,CAAC,OAAO,EAAE,KAAK,IAAI,EAAE;wBAAE,WAAU;;0CAC3C,8OAAC;gCAAK,WAAU;0CAAiD;;;;;;0CACjE,8OAAC;gCAAE,WAAU;0CAAiE,KAAK,KAAK;;;;;;;;;;;+BAExF;;;;;;;;;;;;;AAIZ","debugId":null}}]
}